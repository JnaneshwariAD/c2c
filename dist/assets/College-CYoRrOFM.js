import{v as x,c as p,S as d,d as ne,r as c,j as e,M as ce,B as T,b as j,e as de,G as u,g as ue,P as ge,f as he,h as fe,i as me,k as B,l as F,m as pe,I as R,E as ye,D as xe,n as be,o as ve,p as Ce,q as m,F as Ie,A as Ee,H as je,J as we,s as Ne,t as z}from"./index-D1P8NqU1.js";const Me=async n=>await x({method:"GET",url:`${p}/college/v1/getAllCollegesByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10`,headers:n}),De=async n=>await x({method:"GET",url:`${p}/university/v1/getAllUniversitys`,headers:n}),Pe=async(n,g)=>{try{const i=await x({method:"POST",url:`${p}/college/v1/createCollege`,headers:g,data:n});return i.data.responseCode===201?d.fire({icon:"success",title:"Success",text:i.data.message||"College added successfully!"}):i.data.responseCode===400&&d.fire({icon:"error",title:"Error",text:i.data.errorMessage||"Something went wrong"}),i}catch(i){d.fire({icon:"error",title:"Error",text:i.message||"An unexpected error occurred"})}},Ue=async(n,g)=>await x({method:"GET",url:`${p}/college/v1/getCollegeByCollegeId/${n}`,headers:g}),Se=async(n,g)=>{try{const i=await x({method:"PUT",url:`${p}/college/v1/updateCollege`,headers:g,data:n});return i.data.responseCode===201?d.fire({icon:"success",title:"Success",text:i.data.message||"College updated successfully!"}):i.data.responseCode===400&&d.fire({icon:"error",title:"Error",text:i.data.errorMessage||"Update failed"}),i}catch(i){d.fire({icon:"error",title:"Error",text:i.message||"An unexpected error occurred"})}},Te=async(n,g)=>{try{if((await d.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed){const y=await x({method:"DELETE",url:`${p}/college/v1/deleteCollegeById/${n}`,headers:g});return y.data.responseCode===200?d.fire({icon:"success",title:"Deleted!",text:y.data.message}):y.data.responseCode===400?d.fire({icon:"error",title:"Error",text:y.data.errorMessage}):d.fire({icon:"warning",title:"Unexpected Response",text:"Unexpected response code received."}),y.data}else return null}catch(i){return d.fire({icon:"error",title:"Error",text:`Error deleting college: ${i.message}`}),null}},k=[{id:"collegeId",label:"ID",align:"center"},{id:"collegeName",label:"Name",align:"center"},{id:"description",label:"Description",minWidth:100,align:"center"},{id:"universityName",label:"University",align:"center"},{id:"file",label:"File",minWidth:100,align:"center"},{id:"webUrl",label:"Web URL",minWidth:400,align:"center"},{id:"address",label:"Address",minWidth:200,align:"center"},{id:"city",label:"City",align:"center"},{id:"state",label:"State",align:"center"},{id:"pincode",label:"Pincode",align:"center"},{id:"createdBy",label:"Created By",align:"center"},{id:"updatedBy",label:"Updated By",align:"center"},{id:"insertedDate",label:"Inserted Date",align:"center"},{id:"updatedDate",label:"Updated Date",align:"center"},{id:"actions",label:"Actions",align:"center"}],ke=()=>{ne();const[n,g]=c.useState(0),[i,y]=c.useState(10),[w,A]=c.useState([]),[G,H]=c.useState([]),[J,h]=c.useState(!1),[N,M]=c.useState(!1),[r,v]=c.useState({collegeName:"",description:"",webUrl:"",address:"",city:"",state:"",pincode:""}),[l,D]=c.useState({}),[P,L]=c.useState(!1),[Y,W]=c.useState(null),[q,O]=c.useState(""),[Be,U]=c.useState(""),[S,V]=c.useState(null),_=c.useRef(null),K=(t,a)=>{g(a)},Q=t=>{y(+t.target.value),g(0)},I=JSON.parse(sessionStorage.getItem("user")),b={"Content-type":"application/json",Authorization:"Bearer "+I.accessToken},X=`${p}/file/downloadFile/?filePath=`,C=async()=>{try{const a=(await Me(b)).data.content;if(console.log(a),a){const s=a.map(o=>({collegeId:o.collegeId,collegeName:o.collegeName,description:o.description,universityName:o.universityDtoList?o.universityDtoList.universityName:"No university",file:o.collegePicPath===null?"NO IMAGE FOUND":e.jsx("img",{src:X+o.collegePicPath,alt:o.collegePicName,style:{width:100,height:50}}),webUrl:o.webUrl,address:o.address,city:o.city,state:o.state,pincode:o.pincode,insertedDate:z(o.insertedDate).format("L"),updatedDate:z(o.updatedDate).format("L"),createdBy:o.createdBy?o.createdBy.userName:"No User",updatedBy:o.updatedBy?o.updatedBy.userName:"No User"}));A(s)}else A([])}catch(t){console.error("Error fetching data:",t)}},Z=async()=>{try{const a=(await De(b)).data;if(a){const o=a.sort((E,le)=>E.universityName.localeCompare(le.universityName)).map(E=>({universityId:E.universityId,universityName:E.universityName}));H(o)}}catch(t){console.error("Error fetching univeristies:",t)}};c.useEffect(()=>{C(),Z()},[P]);const $=()=>{const t={};return(!r.collegeName||r.collegeName.trim()==="")&&(t.collegeName="Enter the college name"),(!r.description||r.description.trim()==="")&&(t.description="Enter the description"),(!r.webUrl||r.webUrl.trim()==="")&&(t.webUrl="Enter the webUrl"),r.universityId||(t.universityId="Select a univeristy"),(!r.address||r.address.trim()==="")&&(t.address="Enter the Address"),(!r.city||r.city.trim()==="")&&(t.city="Enter the City"),(!r.state||r.state.trim()==="")&&(t.state="Enter the State"),(!r.pincode||r.pincode.trim()==="")&&(t.pincode="Enter the Pincode"),t},f=t=>{v({...r,[t.target.name]:t.target.value}),D({...l,[t.target.name]:null})},ee=()=>{M(!1),v({collegeId:"",collegeName:"",description:"",webUrl:"",address:"",city:"",state:"",pincode:""}),h(!0)},te=async t=>{if(t.preventDefault(),!S){U("Please select a file"),d.fire({icon:"error",title:"Oops...",text:"Please select a file to upload!"});return}const a=new FormData;a.append("file",S);try{const s=await x.post(`${p}/file/uploadFile`,a,{headers:{"content-type":"multipart/form-data",Authorization:"Bearer "+I.accessToken}});O(s.data.fileName),v({...r,collegePicName:s.data.fileName}),console.log(s.data),d.fire({target:document.getElementById("your-dialog-id"),icon:"success",title:"Success!",text:s.data.message||"File uploaded successfully",timer:2e3,showConfirmButton:!1}),U("")}catch(s){console.error(s),U("Error uploading file"),d.fire({icon:"error",title:"Upload Failed",text:"There was an error uploading the file"})}},re=t=>{if(O(t.target.files[0].name),V(t.target.files[0]),!S)return!1},se=async t=>{t.preventDefault();const a=$();if(Object.keys(a).length>0){D(a);return}const s={...r,universityDtoList:{universityId:r.universityId},createdBy:{userId:I.userId}};console.log(s);try{const o=await Pe(s,b);o.data.responseCode===201?(L(!P),h(!1),C()):alert(o.data.errorMessage||"Failed to add college.")}catch{}h(!1),C()},oe=async t=>{M(!0),h(!0);try{const s=(await Ue(t,b)).data;console.log(s),W(s.collegeId),v({collegeName:s.collegeName,description:s.description,webUrl:s.webUrl,address:s.address,city:s.city,state:s.state,pincode:s.pincode,universityId:s.universityDtoList?s.universityDtoList.universityId:""})}catch(a){console.error("Error fetching subject details:",a)}},ae=async t=>{t.preventDefault();const a=$();if(Object.keys(a).length>0){D(a);return}const s={collegeId:Y,collegeName:r.collegeName,collegePicName:q,description:r.description,webUrl:r.webUrl,address:r.address,city:r.city,state:r.state,pincode:r.pincode,universityDtoList:{universityId:r.universityId},updatedBy:{userId:I.userId}};console.log(s);try{const o=await Se(s,b);o.data.responseCode===201?(L(!P),h(!1),M(!1),W(null),v({collegeName:"",description:"",webUrl:"",address:"",city:"",state:"",pincode:"",universityId:""})):alert(o.data.errorMessage)}catch(o){console.error(o)}finally{}h(!1),C()},ie=async t=>{try{await Te(t,b),C()}catch(a){console.error("Error deleting college:",a)}};return e.jsxs(ce,{title:e.jsxs(T,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"College"}),e.jsxs(j,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px",backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:ee,children:["Add",e.jsx(de,{sx:{color:"#fff"}})]})]}),children:[e.jsx(u,{container:!0,spacing:ue}),e.jsxs(ge,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(he,{sx:{maxHeight:440},children:e.jsxs(fe,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(me,{children:e.jsx(B,{children:k.map(t=>e.jsx(F,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(pe,{children:w.length===0?e.jsx(B,{children:e.jsx(F,{colSpan:k.length,align:"center",children:"No courses found"})}):w.slice(n*i,n*i+i).map((t,a)=>(console.log(`Row ${a} - College ID:`,t.collegeId),e.jsx(B,{hover:!0,role:"checkbox",tabIndex:-1,children:k.map(s=>e.jsx(F,{align:s.align,children:s.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(R,{sx:{color:"#03045E"},onClick:()=>oe(t.collegeId),children:e.jsx(ye,{})}),e.jsx(R,{color:"error",onClick:()=>ie(t.collegeId),children:e.jsx(xe,{})})]}):t[s.id]||"â€”"},`${t.collegeId}-${s.id}`))},t.collegeId||`row-${a}`)))})]})}),e.jsx(be,{rowsPerPageOptions:[10,25,100],component:"div",count:w.length,rowsPerPage:i,page:n,onPageChange:K,onRowsPerPageChange:Q})]}),e.jsxs(ve,{open:J,onClose:()=>h(!1),fullWidth:!0,maxWidth:"md",id:"your-dialog-id",children:[e.jsx(Ce,{sx:{fontSize:"16px"},children:N?"Edit College":"Add College"}),e.jsxs(T,{component:"form",onSubmit:N?ae:se,noValidate:!0,sx:{p:3},children:[e.jsxs(u,{container:!0,spacing:2,children:[e.jsx(u,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"College Name",name:"collegeName",value:r.collegeName,onChange:f,error:!!l.collegeName,helperText:l.collegeName,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"Description",name:"description",value:r.description,onChange:f,error:!!l.description,helperText:l.description,multiline:!0,rows:3,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,children:e.jsxs(Ie,{fullWidth:!0,error:!!l.universityId,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}},children:[e.jsx(Ee,{children:"University"}),e.jsx(je,{name:"universityId",value:r.universityId,onChange:f,label:"University",children:G.map(t=>e.jsx(we,{value:t.universityId,children:t.universityName},t.universityId))}),l.universityId&&e.jsx(T,{component:"span",sx:{color:"error.main",fontSize:"0.75rem",mt:1},children:l.universityId})]})}),e.jsxs(u,{item:!0,xs:12,children:[e.jsx(m,{margin:"normal",fullWidth:!0,id:"collegePicName",label:"File Name",name:"collegePicName",autoComplete:"collegePicName",value:r.collegePicName,disabled:!0,helperText:l.collegePicName,error:!!l.collegePicName,InputProps:{endAdornment:e.jsx(j,{variant:"contained",color:"primary",onClick:te,sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},children:"Upload"})}}),e.jsx("input",{type:"file",onChange:re,ref:_,style:{marginTop:20}})]}),e.jsx(u,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"webUrl ",name:"webUrl",value:r.webUrl,onChange:f,error:!!l.webUrl,helperText:l.webUrl,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Address ",name:"address",value:r.address,onChange:f,error:!!l.address,helperText:l.address,multiline:!0,rows:2,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"City ",name:"city",value:r.city,onChange:f,error:!!l.city,helperText:l.city,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"State ",name:"state",value:r.state,onChange:f,error:!!l.state,helperText:l.state,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,md:6,sx:{mb:2},children:e.jsx(m,{fullWidth:!0,label:"Pincode ",name:"pincode",value:r.pincode,onChange:f,error:!!l.pincode,helperText:l.pincode,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})})]}),e.jsxs(Ne,{children:[e.jsx(j,{onClick:()=>h(!1),sx:{color:"#03045E"},children:"Cancel"}),e.jsx(j,{type:"submit",variant:"contained",color:"primary",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},children:N?"Update":"Save"})]})]})]})]})};export{ke as default};
