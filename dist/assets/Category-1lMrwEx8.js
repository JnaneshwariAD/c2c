import{v as p,c as f,S as i,d as V,r as l,j as e,M as _,B as k,b as B,e as K,G as C,g as Q,P as X,f as Z,h as ee,i as te,k as M,l as D,m as re,I as U,E as ae,D as oe,n as se,o as ne,p as ie,q as A,s as ce,t as W}from"./index-D1P8NqU1.js";const de=async s=>await p({method:"GET",url:`${f}/category/v1/getAllCategoryByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10`,headers:s}),le=async(s,c)=>await p({method:"GET",url:`${f}/category/v1/getCategoryByCategoryId/{categoryId}?categoryId=${s}`,headers:c}),ge=async(s,c)=>{try{const r=await p({method:"POST",url:`${f}/category/v1/createCategory`,headers:c,data:JSON.stringify(s)});return r.data.responseCode===201?i.fire({icon:"success",title:"Success",text:r.data.message||"Category added successfully!"}):r.data.responseCode===400&&i.fire({icon:"error",title:"Error",text:r.data.errorMessage||"Something went wrong"}),r}catch(r){i.fire({icon:"error",title:"Error",text:r.message||"An unexpected error occurred"})}},ue=async(s,c)=>{try{const r=await p({method:"PUT",url:`${f}/category/v1/updateCategory`,headers:c,data:s});return r.data.responseCode===201?i.fire({icon:"success",title:"Success",text:r.data.message||"Category updated successfully!"}):r.data.responseCode===400&&i.fire({icon:"error",title:"Error",text:r.data.errorMessage||"Update failed"}),r}catch(r){i.fire({icon:"error",title:"Error",text:r.message||"An unexpected error occurred"})}},ye=async(s,c)=>{try{if((await i.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed){const u=await p({method:"DELETE",url:`${f}/category/v1/deleteCategoryById/${s}`,headers:c});return u.data.responseCode===200?i.fire({icon:"success",title:"Deleted!",text:u.data.message}):u.data.responseCode===400?i.fire({icon:"error",title:"Error",text:u.data.errorMessage}):i.fire({icon:"warning",title:"Unexpected Response",text:"Unexpected response code received."}),u.data}else return null}catch(r){return i.fire({icon:"error",title:"Error",text:`Error deleting category: ${r.message}`}),null}},O=[{id:"categoryId",label:"ID"},{id:"categoryName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],pe=()=>{V();const[s,c]=l.useState(0),[r,u]=l.useState(10),[v,w]=l.useState([]),[$,g]=l.useState(!1),[b,j]=l.useState(!1),[d,E]=l.useState({categoryName:"",description:""}),[y,N]=l.useState({}),[I,S]=l.useState(!1),[R,T]=l.useState(null),z=(t,o)=>{c(o)},F=t=>{u(+t.target.value),c(0)},x=JSON.parse(sessionStorage.getItem("user")),h={"Content-type":"application/json",Authorization:"Bearer "+x.accessToken},m=async()=>{try{const o=(await de(h)).data.content;if(o){const a=o.map(n=>({categoryId:n.categoryId,categoryName:n.categoryName,description:n.description,insertedDate:W(n.insertedDate).format("L"),updatedDate:W(n.updatedDate).format("L"),createdBy:n.createdBy?n.createdBy.userName:"No User",updatedBy:n.updatedBy?n.updatedBy.userName:"No User"}));w(a)}else w([])}catch(t){console.error("Error fetching data:",t)}};l.useEffect(()=>{m()},[I]);const L=()=>{const t={};return(!d.categoryName||d.categoryName.trim()==="")&&(t.categoryName="Enter the category name"),(!d.description||d.description.trim()==="")&&(t.description="Enter the description"),t},P=t=>{E({...d,[t.target.name]:t.target.value,createdBy:{userId:x.userId}}),N({...y,[t.target.name]:null})},G=()=>{j(!1),E({categoryName:"",description:""}),g(!0)},H=async t=>{j(!0),g(!0);try{const a=(await le(t,h)).data;T(a.categoryId),E({categoryName:a.categoryName,description:a.description})}catch(o){console.error("Error fetching category details:",o)}},J=async t=>{try{await ye(t,h),m()}catch(o){console.error("Error deleting category:",o)}},Y=async t=>{t.preventDefault();const o=L();if(Object.keys(o).length>0){N(o);return}const a={...d,createdBy:{userId:x.userId}};console.log(a);try{const n=await ge(a,h);console.log(n),n.data.responseCode===201&&(S(!I),g(!1))}catch(n){console.log(n)}m(),g(!1)},q=async t=>{t.preventDefault();const o={categoryId:R,categoryName:d.categoryName,description:d.description,updatedBy:{userId:x.userId}};try{(await ue(o,h)).data.responseCode===201&&(S(!I),g(!1),j(!1),T(null))}catch{}m(),g(!1)};return e.jsxs(_,{title:e.jsxs(k,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Category"}),e.jsxs(B,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px",backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:G,children:["Add",e.jsx(K,{sx:{color:"#fff"}})]})]}),children:[e.jsx(C,{container:!0,spacing:Q}),e.jsxs(X,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(Z,{sx:{maxHeight:440},children:e.jsxs(ee,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(te,{children:e.jsx(M,{children:O.map(t=>e.jsx(D,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(re,{children:v.slice(s*r,s*r+r).map((t,o)=>e.jsxs(M,{hover:!0,role:"checkbox",tabIndex:-1,children:[e.jsx(D,{align:"left",children:s*r+o+1}),O.filter(a=>a.id!=="categoryId").map(a=>e.jsx(D,{align:a.align,children:a.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(U,{onClick:()=>H(t.categoryId),sx:{color:"#03045E"},children:e.jsx(ae,{})}),e.jsx(U,{onClick:()=>J(t.categoryId),color:"error",children:e.jsx(oe,{})})]}):t[a.id]},a.id))]},t.categoryId))})]})}),e.jsx(se,{rowsPerPageOptions:[10,25,100],component:"div",count:v.length,rowsPerPage:r,page:s,onPageChange:z,onRowsPerPageChange:F})]}),e.jsxs(ne,{open:$,onClose:()=>g(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(ie,{sx:{fontSize:"16px"},children:b?"Edit Category":"Add Category"}),e.jsxs(k,{component:"form",onSubmit:b?q:Y,noValidate:!0,sx:{p:3},children:[e.jsxs(C,{container:!0,spacing:2,children:[e.jsx(C,{item:!0,xs:12,children:e.jsx(A,{fullWidth:!0,label:"Category Name",name:"categoryName",value:d.categoryName,onChange:P,error:!!y.categoryName,helperText:y.categoryName,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(C,{item:!0,xs:12,children:e.jsx(A,{fullWidth:!0,label:"Description",name:"description",value:d.description,onChange:P,error:!!y.description,helperText:y.description,multiline:!0,rows:3,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})})]}),e.jsxs(ce,{children:[e.jsx(B,{onClick:()=>g(!1),sx:{color:"#03045E"},children:"Cancel"}),e.jsx(B,{type:"submit",variant:"contained",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},children:b?"Update":"Save"})]})]})]})]})};export{pe as default};
