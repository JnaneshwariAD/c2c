import{v as b,c as v,S as p,d as ce,r as h,j as e,M as le,B as G,b as w,e as ue,G as c,g as he,P as ge,f as me,h as fe,i as pe,k as F,l as $,m as ye,I as R,E as xe,D as be,n as ve,o as Ie,p as Ce,q as m,F as U,A,H as B,J as L,s as Me,t as z}from"./index-D1P8NqU1.js";const je=async d=>await b({method:"GET",url:`${v}/course/v1/getAllCourseByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10`,headers:d}),Pe=async d=>await b({method:"GET",url:`${v}/university/v1/getAllUniversitys`,headers:d}),Ee=async d=>await b({method:"GET",url:`${v}/category/v1/queryAllCategory`,headers:d}),De=async d=>await b({method:"GET",url:`${v}/branch/v1/queryAllBranchs`,headers:d}),Ne=async(d,f)=>{try{const n=await b({method:"POST",url:`${v}/course/v1/createCourse`,headers:f,data:d});return n.data.responseCode===201?p.fire("Success",n.data.message,"success"):n.data.responseCode===400&&p.fire("Error",n.data.errorMessage,"error"),n}catch(n){throw p.fire("Error",n.message,"error"),n}},Te=async(d,f)=>await b({method:"GET",url:`${v}/course/v1/getCourseByCourseId/{courseId}?courseId=${d}`,headers:f}),Se=async(d,f)=>{try{const n=await b({method:"PUT",url:`${v}/course/v1/updateCourse`,headers:f,data:d});return n.data.responseCode===201?p.fire("Success",n.data.message,"success"):n.data.responseCode===400&&p.fire("Error",n.data.errorMessage,"error"),n}catch(n){throw p.fire("Error",n.message,"error"),n}},we=async(d,f)=>{var j,I;if((await p.fire({title:"Are you sure?",text:"This course will be permanently deleted!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{const g=await b({method:"DELETE",url:`${v}/course/v1/deleteCourseById/${d}`,headers:f});return g.data.responseCode===200?p.fire("Deleted!",g.data.message,"success"):g.data.responseCode===400&&p.fire("Error",g.data.errorMessage,"error"),g}catch(g){throw p.fire("Error",((I=(j=g.response)==null?void 0:j.data)==null?void 0:I.errorMessage)||g.message,"error"),g}},H=[{id:"courseId",label:"ID"},{id:"courseName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"categoryName",label:"Category"},{id:"universityName",label:"University"},{id:"branchName",label:"Branch"},{id:"courseMrp",label:"MRP"},{id:"discount",label:"Discount"},{id:"sellingPrice",label:"Selling Price"},{id:"gst",label:"GST"},{id:"gstAmount",label:"GST Amount"},{id:"activePeriod",label:"Active Period"},{id:"trailPeriod",label:"Trail Period"},{id:"semester",label:"Semester"},{id:"videoUrl",label:"Video URL",format:d=>d?e.jsx("iframe",{width:"200",height:"100",src:d,title:"Course video",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):"No video"},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],Ae=()=>{ce();const[d,f]=h.useState(0),[n,j]=h.useState(10),[I,g]=h.useState([]),[q,V]=h.useState([]),[J,y]=h.useState(!1),[E,D]=h.useState(!1),[t,P]=h.useState({courseName:"",description:"",courseMrp:"",discount:"",sellingPrice:"",gst:"",gstAmount:"",activePeriod:"",trailPeriod:"",semester:"",videoUrl:"",categoryId:"",universityId:"",branchId:""}),[a,N]=h.useState({}),[T,W]=h.useState(!1),[Y,_]=h.useState([]),[K,Q]=h.useState([]),[X,O]=h.useState(null),Z=(r,o)=>{f(o)},ee=r=>{j(+r.target.value),f(0)},S=JSON.parse(sessionStorage.getItem("user")),x={"Content-type":"application/json",Authorization:"Bearer "+S.accessToken},re=async()=>{try{const o=(await Ee(x)).data;if(console.log(o),o){const s=o.sort((u,M)=>u.categoryName.localeCompare(M.categoryName)).map(u=>({categoryId:u.categoryId,categoryName:u.categoryName}));V(s)}}catch(r){console.error("Error fetching categories:",r)}},te=async()=>{try{const o=(await Pe(x)).data;if(o){const s=o.sort((u,M)=>u.universityName.localeCompare(M.universityName)).map(u=>({universityId:u.universityId,universityName:u.universityName}));_(s)}}catch(r){console.error("Error fetching univeristies:",r)}},se=async()=>{try{const o=(await De(x)).data;if(console.log(o),o){const s=o.sort((u,M)=>u.branchName.localeCompare(M.branchName)).map(u=>({branchId:u.branchId,branchName:u.branchName}));Q(s)}}catch(r){console.error("Error fetching univeristies:",r)}},C=async()=>{try{const o=(await je(x)).data.content;if(o){const i=o.map(s=>({courseId:s.courseId,courseName:s.courseName,description:s.description,courseMrp:s.courseMrp,discount:s.discount,gst:s.gst,gstAmount:s.gstAmount,sellingPrice:s.sellingPrice,activePeriod:s.activePeriod,trailPeriod:s.trailPeriod,semester:s.semester,categoryName:s.courseCategoryDto?s.courseCategoryDto.categoryName:"No Category",universityName:s.universityDtoList?s.universityDtoList.universityName:"No university",branchName:s.branchDtoList?s.branchDtoList.branchName:"No branch",videoUrl:s.videoUrl,insertedDate:z(s.insertedDate).format("L"),updatedDate:z(s.updatedDate).format("L"),createdBy:s.createdBy?s.createdBy.userName:"No User",updatedBy:s.updatedBy?s.updatedBy.userName:"No User"}));g(i)}else g([])}catch(r){console.error("Error fetching data:",r)}};h.useEffect(()=>{C(),re(),te(),se()},[T]);const k=()=>{const r={};return(!t.courseName||t.courseName.trim()==="")&&(r.courseName="Enter the course name"),(!t.description||t.description.trim()==="")&&(r.description="Enter the description"),(!t.videoUrl||t.videoUrl.trim()==="")&&(r.videoUrl="Enter the videoUrl"),t.categoryId||(r.categoryId="Select a category"),r},l=r=>{P({...t,[r.target.name]:r.target.value}),N({...a,[r.target.name]:null})},oe=()=>{D(!1),P({courseName:"",description:"",discount:"",handlingFee:"",sellingPrice:"",subscriptionDays:"",trailPeriod:"",videoUrl:"",categoryId:""}),y(!0)},ae=async r=>{r.preventDefault();const o=k();if(Object.keys(o).length>0){N(o);return}const i={courseName:t.courseName,description:t.description,courseMrp:t.courseMrp,discount:t.discount,sellingPrice:t.sellingPrice,gst:t.gst,gstAmount:t.gstAmount,activePeriod:t.activePeriod,trailPeriod:t.trailPeriod,semester:t.semester,videoUrl:t.videoUrl,courseCategoryDto:{categoryId:t.categoryId},universityDtoList:{universityId:t.universityId},branchDtoList:{branchId:t.branchId},createdBy:{userId:S.userId}};console.log(i);try{const s=await Ne(i,x);s.data.responseCode===201?(W(!T),y(!1),C()):alert(s.data.errorMessage||"Failed to add course.")}catch{}C(),y(!1)},ie=async r=>{D(!0),y(!0);try{const i=(await Te(r,x)).data;O(i.courseId),P({courseName:i.courseName,description:i.description,courseMrp:i.courseMrp,discount:i.discount,sellingPrice:i.sellingPrice,gst:i.gst,gstAmount:i.gstAmount,activePeriod:i.activePeriod,trailPeriod:i.trailPeriod,semester:i.semester,videoUrl:i.videoUrl,categoryId:i.courseCategoryDto?i.courseCategoryDto.categoryId:"",universityId:i.universityDtoList?i.universityDtoList.universityId:"",branchId:i.branchDtoList?i.branchDtoList.branchId:""})}catch(o){console.error("Error fetching subject details:",o)}},ne=async r=>{r.preventDefault();const o=k();if(Object.keys(o).length>0){N(o);return}const i={courseId:X,courseName:t.courseName,description:t.description,courseMrp:t.courseMrp,discount:t.discount,sellingPrice:t.sellingPrice,gst:t.gst,gstAmount:t.gstAmount,activePeriod:t.activePeriod,trailPeriod:t.trailPeriod,semester:t.semester,videoUrl:t.videoUrl,courseCategoryDto:{categoryId:t.categoryId},universityDtoList:{universityId:t.universityId},branchDtoList:{branchId:t.branchId},updatedBy:{userId:S.userId}};try{const s=await Se(i,x);s.data.responseCode===201?(W(!T),y(!1),D(!1),O(null),P({...t})):alert(s.data.errorMessage)}catch{C(),y(!1)}},de=async r=>{try{await we(r,x),C()}catch(o){console.error("Error deleting subject:",o)}};return e.jsxs(le,{title:e.jsxs(G,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:" Courses"}),e.jsxs(w,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px",backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:oe,children:["Add",e.jsx(ue,{sx:{color:"#fff"}})]})]}),children:[e.jsx(c,{container:!0,spacing:he}),e.jsxs(ge,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(me,{sx:{maxHeight:440},children:e.jsxs(fe,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(pe,{children:e.jsx(F,{children:H.map(r=>e.jsx($,{align:r.align,style:{minWidth:r.minWidth,fontWeight:600,fontSize:15},children:r.label},r.id))})}),e.jsx(ye,{children:I.slice(d*n,d*n+n).map(r=>e.jsx(F,{hover:!0,role:"checkbox",tabIndex:-1,children:H.map(o=>e.jsx($,{align:o.align,children:o.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(R,{sx:{color:"#03045E"},onClick:()=>{ie(r.courseId)},children:e.jsx(xe,{})}),e.jsx(R,{color:"error",onClick:()=>{de(r.courseId)},children:e.jsx(be,{})})]}):o.format?o.format(r[o.id]):r[o.id]},o.id))},r.categoryId))})]})}),e.jsx(ve,{rowsPerPageOptions:[10,25,100],component:"div",count:I.length,rowsPerPage:n,page:d,onPageChange:Z,onRowsPerPageChange:ee})]}),e.jsxs(Ie,{open:J,onClose:()=>y(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(Ce,{sx:{fontSize:"16px"},children:E?"Edit Courses":"Add Courses"}),e.jsxs(G,{component:"form",onSubmit:E?ne:ae,noValidate:!0,sx:{p:3},children:[e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"Course Name",name:"courseName",value:t.courseName,onChange:l,error:!!a.courseName,helperText:a.courseName,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"Description",name:"description",value:t.description,onChange:l,error:!!a.description,helperText:a.description,multiline:!0,rows:3,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(U,{fullWidth:!0,sx:{mb:2,"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}},children:[e.jsx(A,{children:"Category"}),e.jsx(B,{name:"categoryId",value:t.categoryId,onChange:l,error:!!a.categoryId,helperText:a.categoryId,children:q.map(r=>e.jsx(L,{value:r.categoryId,children:r.categoryName},r.categoryId))})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(U,{fullWidth:!0,sx:{mb:2,"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}},children:[e.jsx(A,{children:"University"}),e.jsx(B,{name:"universityId",value:t.universityId,onChange:l,error:!!a.universityId,helperText:a.universityId,children:Y.map(r=>e.jsx(L,{value:r.universityId,children:r.universityName},r.universityId))})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsxs(U,{fullWidth:!0,sx:{mb:2,"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}},children:[e.jsx(A,{children:"Branch"}),e.jsx(B,{name:"branchId",value:t.branchId,onChange:l,error:!!a.branchId,helperText:a.branchId,children:K.map(r=>e.jsx(L,{value:r.branchId,children:r.branchName},r.branchId))})]})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"MRP",name:"courseMrp",value:t.courseMrp,onChange:l,error:!!a.courseMrp,helperText:a.courseMrp,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Discount",name:"discount",value:t.discount,onChange:l,error:!!a.discount,helperText:a.discount,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Selling Price",name:"sellingPrice",value:t.sellingPrice,onChange:l,error:!!a.sellingPrice,helperText:a.sellingPrice,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"GST",name:"gst",value:t.gst,onChange:l,error:!!a.gst,helperText:a.gst,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"GST Amount",name:"gstAmount",value:t.gstAmount,onChange:l,error:!!a.gstAmount,helperText:a.gstAmount,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Active Period ",name:"activePeriod",value:t.activePeriod,onChange:l,error:!!a.activePeriod,helperText:a.activePeriod,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Trail Period ",name:"trailPeriod",value:t.trailPeriod,onChange:l,error:!!a.trailPeriod,helperText:a.trailPeriod,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Semester ",name:"semester",value:t.semester,onChange:l,error:!!a.semester,helperText:a.semester,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"VideoUrl ",name:"videoUrl",value:t.videoUrl,onChange:l,error:!!a.videoUrl,helperText:a.videoUrl,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})})]}),e.jsxs(Me,{children:[e.jsx(w,{onClick:()=>y(!1),sx:{color:"#03045E"},children:"Cancel"}),e.jsx(w,{type:"submit",variant:"contained",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},children:E?"Update":"Save"})]})]})]})]})};export{Ae as default};
