import{d as te,r as n,j as e,M as ae,B as P,b as g,e as re,G as u,g as se,P as ne,f as ie,h as oe,i as le,k as F,l as k,m as de,I as T,E as ce,D as me,n as ue,o as fe,p as he,q as v,s as ge,t as A,v as pe,c as M,S as U}from"./index-D1P8NqU1.js";import{f as xe,u as ve,a as Ne,g as ye,d as be}from"./BannerApi-BXq71oNe.js";const W=[{id:"advertisementId",label:"ID",align:"center"},{id:"advertisementName",label:"Name",align:"center"},{id:"description",label:"Description",minWidth:100},{id:"file",label:"File",align:"center"},{id:"createdBy",label:"Created By",align:"center"},{id:"updatedBy",label:"Updated By",align:"center"},{id:"insertedDate",label:"Inserted Date",align:"center"},{id:"updatedDate",label:"Updated Date",align:"center"},{id:"actions",label:"Actions",align:"center"}],Ie=()=>{te();const[p,N]=n.useState(0),[f,O]=n.useState(10),[y,b]=n.useState([]),[R,d]=n.useState(!1),[x,j]=n.useState(!1),[i,c]=n.useState({advertisementName:"",description:"",fileName:""}),[l,E]=n.useState({}),[je,C]=n.useState(""),[Ee,B]=n.useState(""),[I,z]=n.useState(null),[H,L]=n.useState(!1),[G,$]=n.useState(null),D=n.useRef(null),q=(t,a)=>{N(a)},J=t=>{O(+t.target.value),N(0)},h=JSON.parse(sessionStorage.getItem("user")),m={"Content-type":"application/json",Authorization:"Bearer "+h.accessToken},V=`${M}/file/downloadFile/?filePath=`,S=async()=>{try{const a=(await xe(m)).data.content;if(console.log(a),a){const s=a.map(r=>({advertisementId:r.advertisementId,advertisementName:r.advertisementName?r.advertisementName:"Not Found",description:r.description?r.description:"Not Found",file:r.filePath===null?"NO IMAGE FOUND":e.jsx("img",{src:V+r.filePath,alt:r.fileName,style:{width:100,height:50}}),insertedDate:A(r.insertedDate).format("L"),updatedDate:A(r.updatedDate).format("L"),createdBy:r.createdBy?r.createdBy.userName:"No User",updatedBy:r.updatedBy?r.updatedBy.userName:"No User"}));b(s)}else b([])}catch(t){console.error("Error fetching data:",t)}};n.useEffect(()=>{S()},[H]);const Y=async t=>{t.preventDefault();const a=Q();if(Object.keys(a).length>0)E(a);else try{if(x){const s={...i,advertisementId:G,updatedBy:{userId:h.userId}};await ve(s,m)}else await Ne(i,m);c({advertisementName:"",description:"",fileName:""}),D.current.value=null,L(s=>!s),d(!1)}catch(s){console.error("Error saving advertisement:",s)}},_=async t=>{var s,r;if(t.preventDefault(),!I){C("Please select a file");return}const a=new FormData;a.append("file",I);try{const o=await pe.post(`${M}/file/uploadFile`,a,{headers:{"content-type":"multipart/form-data",Authorization:"Bearer "+h.accessToken}});B(o.data.fileName),c({...i,fileName:o.data.fileName}),C(""),U.fire({target:document.getElementById("your-dialog-id"),icon:"success",title:"Upload Successful",text:o.data.message||"Your file has been uploaded successfully.",timer:2500,showConfirmButton:!1})}catch(o){console.error("Error uploading file:",o),U.fire({icon:"error",title:"Upload Failed",text:((r=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:r.errorMessage)||"Something went wrong during file upload.",confirmButtonColor:"#d33"})}},K=t=>{B(t.target.files[0].name),z(t.target.files[0])},Q=()=>{const t={};return(!i.advertisementName||i.advertisementName.trim()==="")&&(t.advertisementName="Enter the Advertisement name"),(!i.description||i.description.trim()==="")&&(t.description="Enter the description"),(!i.fileName||i.fileName.trim()==="")&&(t.fileName="Select the file"),t},w=t=>{c({...i,[t.target.name]:t.target.value,createdBy:{userId:h.userId}}),E({...l,[t.target.name]:null})},X=()=>{j(!1),c({advertisementName:"",description:"",fileName:""}),d(!0)},Z=async t=>{j(!0),d(!0);try{const s=(await ye(t,m)).data;$(s.advertisementId),c({advertisementName:s.advertisementName,description:s.description,fileName:s.fileName})}catch(a){console.error("Error fetching advertisement details:",a)}},ee=async t=>{try{await be(t,m),S()}catch(a){console.error("Error deleting advertisement:",a)}};return e.jsxs(ae,{title:e.jsxs(P,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Banner"}),e.jsxs(g,{variant:"contained",sx:{display:"flex",alignItems:"center",fontSize:"15px",backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:X,children:["Add",e.jsx(re,{sx:{color:"#fff"}})]})]}),children:[e.jsx(u,{container:!0,spacing:se}),e.jsxs(ne,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ie,{sx:{maxHeight:440},children:e.jsxs(oe,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(le,{children:e.jsx(F,{children:W.map(t=>e.jsx(k,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(de,{children:y.slice(p*f,p*f+f).map(t=>e.jsx(F,{hover:!0,role:"checkbox",tabIndex:-1,children:W.map(a=>e.jsx(k,{align:a.align,children:a.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(T,{onClick:()=>Z(t.advertisementId),sx:{color:"#03045E"},children:e.jsx(ce,{})}),e.jsx(T,{onClick:()=>ee(t.advertisementId),color:"error",children:e.jsx(me,{})})]}):t[a.id]},a.id))},t.advertisementId))})]})}),e.jsx(ue,{rowsPerPageOptions:[10,25,100],component:"div",count:y.length,rowsPerPage:f,page:p,onPageChange:q,onRowsPerPageChange:J})]}),e.jsxs(fe,{open:R,onClose:()=>d(!1),fullWidth:!0,maxWidth:"md",id:"your-dialog-id",children:[e.jsx(he,{sx:{fontSize:"16px"},children:x?"Edit Advertisement":"Add Advertisement"}),e.jsxs(P,{component:"form",onSubmit:Y,noValidate:!0,sx:{p:3},children:[e.jsxs(u,{container:!0,spacing:2,children:[e.jsx(u,{item:!0,xs:12,children:e.jsx(v,{fullWidth:!0,label:"Advertisement Name",name:"advertisementName",value:i.advertisementName,onChange:w,error:!!l.advertisementName,helperText:l.advertisementName,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(v,{fullWidth:!0,label:"Description",name:"description",value:i.description,onChange:w,error:!!l.description,helperText:l.description,multiline:!0,rows:3,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsxs(u,{item:!0,xs:12,children:[e.jsx(v,{margin:"normal",fullWidth:!0,id:"fileName",label:"File Name",name:"fileName",autoComplete:"fileName",value:i.fileName,disabled:!0,helperText:l.fileName,error:!!l.fileName,InputProps:{endAdornment:e.jsx(g,{variant:"contained",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:_,children:"Upload"})}}),e.jsx("input",{type:"file",onChange:K,ref:D,style:{marginTop:20}})]})]}),e.jsxs(ge,{children:[e.jsx(g,{onClick:()=>d(!1),sx:{color:"#03045E"},children:"Cancel"}),e.jsx(g,{type:"submit",variant:"contained",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},children:x?"Update":"Save"})]})]})]})]})};export{Ie as default};
