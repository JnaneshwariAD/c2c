import{d as ee,r as i,j as e,M as ae,B as T,b as g,e as te,G as u,g as re,P as le,f as se,h as ie,i as oe,k as F,l as w,m as ne,I as U,E as de,D as ce,n as ue,o as me,p as fe,q as p,s as he,t as A,v as be,c as W}from"./index-D1P8NqU1.js";import{u as ge,a as pe}from"./BannerApi-BXq71oNe.js";import{b as xe,c as Ne,e as Ie,h as ye}from"./UsersApi-DzfOKQVp.js";const O=[{id:"mobileUserId",label:"ID",align:"center"},{id:"file",label:"File",align:"center"},{id:"fullName",label:"Name",align:"center"},{id:"mobileNumber",label:"Mobile Number",minWidth:150,align:"center"},{id:"mailId",label:"Mail ID",minWidth:150,align:"center"},{id:"createdBy",label:"Created By",align:"center"},{id:"updatedBy",label:"Updated By",align:"center"},{id:"insertedDate",label:"Inserted Date",align:"center"},{id:"updatedDate",label:"Updated Date",align:"center"},{id:"actions",label:"Actions",align:"center"}],De=()=>{ee();const[x,E]=i.useState(0),[f,R]=i.useState(10),[v,P]=i.useState([]),[z,n]=i.useState(!1),[h,N]=i.useState(!1),[s,d]=i.useState({fullName:"",mobileNumber:"",mailId:"",fileName:""}),[o,I]=i.useState({}),[je,y]=i.useState(""),[Ce,D]=i.useState(""),[j,L]=i.useState(""),[B,M]=i.useState(!1),[H,G]=i.useState(null),S=i.useRef(null),$=(a,r)=>{E(r)},q=a=>{R(+a.target.value),E(0)},m=JSON.parse(sessionStorage.getItem("user")),c={"Content-type":"application/json",Authorization:"Bearer "+m.accessToken},J=`${W}/file/downloadFile/?filePath=`,b=async()=>{try{const r=(await xe(c)).data.content;if(console.log(r),r){const t=r.map(l=>({mobileUserId:l.mobileUserId,fullName:l.fullName,mobileNumber:l.mobileNumber,mailId:l.mailId===null?"Email not found":l.mailId,file:l.profilePicPath===null?"NO IMAGE FOUND":e.jsx("img",{src:J+l.profilePicPath,alt:l.profilePicName,style:{width:100,height:50}}),insertedDate:A(l.insertedDate).format("L"),updatedDate:A(l.updatedDate).format("L"),createdBy:l.createdBy?l.createdBy.userName:"No User",updatedBy:l.updatedBy?l.updatedBy.userName:"No User"}));P(t)}else P([])}catch(a){console.error("Error fetching data:",a)}};i.useEffect(()=>{b()},[B]);const V=async a=>{a.preventDefault();const r=k();if(Object.keys(r).length>0)I(r);else try{if(h){const t={...s,advertisementId:H,updatedBy:{userId:m.userId}};await ge(t,c)}else await pe(s,c);d({advertisementName:"",description:"",fileName:""}),S.current.value=null,M(t=>!t),n(!1)}catch(t){console.error("Error saving advertisement:",t)}},_=async a=>{if(a.preventDefault(),!j){y("Please select a file");return}const r=new FormData;r.append("file",j);try{const t=await be.post(`${W}/file/uploadFile`,r,{headers:{"content-type":"multipart/form-data",Authorization:"Bearer "+m.accessToken}});D(t.data.fileName),d({...s,profilePicName:t.data.fileName}),console.log(t.data),alert(t.data.message),y("")}catch(t){console.error("Error uploading file:",t),y("Error uploading file: "+t.message)}},K=a=>{if(D(a.target.files[0].name),L(a.target.files[0]),!j)return!1},k=()=>{const a={};return(!s.fullName||s.fullName.trim()==="")&&(a.fullName="Enter the name"),(!s.mobileNumber||s.mobileNumber.trim()==="")&&(a.mobileNumber="Enter the mobile Number"),(!s.mailId||s.mailId.trim()==="")&&(a.mailId="Enter the mobile Number"),a},C=a=>{d({...s,[a.target.name]:a.target.value,createdBy:{userId:m.userId}}),I({...o,[a.target.name]:null})},Q=()=>{N(!1),d({fullName:"",mobileNumber:"",mailId:"",fileName:""}),n(!0)},X=async a=>{N(!0),n(!0);try{const t=(await Ne(a,c)).data;console.log(t),G(t.mobileUserId),d({fullName:t.fullName,mobileNumber:t.mobileNumber,mailId:t.mailId,profilePicName:t.profilePicName})}catch(r){console.error("Error fetching advertisement details:",r)}},Y=async a=>{a.preventDefault();const r=k();if(Object.keys(r).length>0){I(r);return}const t={fullName:s.fullName,mobileNumber:s.mobileNumber,mailId:s.mailId,updatedBy:{userId:m.userId}};console.log(t);try{const l=await Ie(t,c);l.data.responseCode===201?(M(!B),n(!1),N(!1),setModuletId(null),d({fullName:"",mobileNumber:"",mailId:""}),setSelectedCourses([]),b()):alert(l.data.errorMessage)}catch{}b()},Z=async a=>{try{await ye(a,c),b()}catch(r){console.error("Error deleting candidate:",r)}};return e.jsxs(ae,{title:e.jsxs(T,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Candidates"}),e.jsxs(g,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px",backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:Q,children:["Add",e.jsx(te,{sx:{color:"#fff"}})]})]}),children:[e.jsx(u,{container:!0,spacing:re}),e.jsxs(le,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(se,{sx:{maxHeight:440},children:e.jsxs(ie,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(oe,{children:e.jsx(F,{children:O.map(a=>e.jsx(w,{align:a.align,style:{minWidth:a.minWidth,fontWeight:600,fontSize:15},children:a.label},a.id))})}),e.jsx(ne,{children:v.slice(x*f,x*f+f).map(a=>e.jsx(F,{hover:!0,role:"checkbox",tabIndex:-1,children:O.map(r=>e.jsx(w,{align:r.align,children:r.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(U,{onClick:()=>X(a.mobileUserId),sx:{color:"#03045E"},children:e.jsx(de,{})}),e.jsx(U,{onClick:()=>Z(a.mobileUserId),color:"error",children:e.jsx(ce,{})})]}):a[r.id]},r.id))},a.advertisementId))})]})}),e.jsx(ue,{rowsPerPageOptions:[10,25,100],component:"div",count:v.length,rowsPerPage:f,page:x,onPageChange:$,onRowsPerPageChange:q})]}),e.jsxs(me,{open:z,onClose:()=>n(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(fe,{sx:{fontSize:"16px"},children:h?"Edit Candidate":"Add Candidate"}),e.jsxs(T,{component:"form",onSubmit:h?Y:V,noValidate:!0,sx:{p:3},children:[e.jsxs(u,{container:!0,spacing:2,children:[e.jsx(u,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Full Name",name:"fullName",value:s.fullName,onChange:C,error:!!o.fullName,helperText:o.fullName,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Mobile Number",name:"mobileNumber",value:s.mobileNumber,onChange:C,error:!!o.mobileNumber,helperText:o.mobileNumber,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(u,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Mail Id",name:"mailId",value:s.mailId,onChange:C,error:!!o.mailId,helperText:o.mailId,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsxs(u,{item:!0,xs:12,children:[e.jsx(p,{margin:"normal",fullWidth:!0,id:"profilePicName",label:"File Name",name:"profilePicName",autoComplete:"profilePicName",value:s.profilePicName,disabled:!0,helperText:o.profilePicName,error:!!o.profilePicName,InputProps:{endAdornment:e.jsx(g,{variant:"contained",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:_,children:"Upload"})}}),e.jsx("input",{type:"file",onChange:K,ref:S,style:{marginTop:20}})]})]}),e.jsxs(he,{children:[e.jsx(g,{onClick:()=>n(!1),sx:{color:"#03045E"},children:"Cancel"}),e.jsx(g,{type:"submit",variant:"contained",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},children:h?"Update":"Save"})]})]})]})]})};export{De as default};
