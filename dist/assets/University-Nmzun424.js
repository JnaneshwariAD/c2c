import{v as g,c as m,S as d,d as ie,r as l,j as e,M as se,B as A,b as E,e as ae,G as h,g as ne,P as oe,f as le,h as de,i as ce,k as O,l as B,m as ue,I as W,E as ye,D as ve,n as fe,o as me,p as pe,q as P,s as he,t as $}from"./index-D1P8NqU1.js";const ge=async o=>await g({method:"get",url:`${m}/university/v1/getAllUniversityByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10`,headers:o}),xe=async(o,c)=>await g({method:"GET",url:`${m}/university/v1/getUniversityById/${o}`,headers:c}),Ce=async(o,c)=>{try{const i=await g({method:"POST",url:`${m}/university/v1/createUniversity`,headers:c,data:o});return i.data.responseCode===201?d.fire({icon:"success",title:"Success",text:i.data.message||"University added successfully!"}):i.data.responseCode===400&&d.fire({icon:"error",title:"Error",text:i.data.errorMessage||"Something went wrong"}),i}catch(i){d.fire({icon:"error",title:"Error",text:i.message||"An unexpected error occurred"})}},be=async(o,c)=>{try{if((await d.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed){const v=await g({method:"DELETE",url:`${m}/university/v1/deleteUniversityById/${o}`,headers:c});return v.data.responseCode===200?d.fire({icon:"success",title:"Deleted!",text:v.data.message}):v.data.responseCode===400?d.fire({icon:"error",title:"Error",text:v.data.errorMessage}):d.fire({icon:"warning",title:"Unexpected Response",text:"Unexpected response code received."}),v.data}else return null}catch(i){return d.fire({icon:"error",title:"Error",text:`Error deleting university: ${i.message}`}),null}},Ne=async(o,c)=>{try{const i=await g({method:"PUT",url:`${m}/university/v1/updateUniversity`,headers:c,data:o});return i.data.responseCode===201?d.fire({icon:"success",title:"Success",text:i.data.message||"University updated successfully!"}):i.data.responseCode===400&&d.fire({icon:"error",title:"Error",text:i.data.errorMessage||"Update failed"}),i}catch(i){d.fire({icon:"error",title:"Error",text:i.message||"An unexpected error occurred"})}},R=[{id:"universityId",label:"ID",align:"center"},{id:"universitycode",label:"University Code",align:"center"},{id:"universityName",label:"Name",align:"center"},{id:"description",label:"Description",minWidth:100},{id:"file",label:"File",align:"center"},{id:"createdBy",label:"Created By",align:"center"},{id:"updatedBy",label:"Updated By",align:"center"},{id:"insertedDate",label:"Inserted Date",align:"center"},{id:"updatedDate",label:"Updated Date",align:"center"},{id:"actions",label:"Actions",align:"center"}],je=()=>{ie();const[o,c]=l.useState(0),[i,v]=l.useState(10),[D,S]=l.useState([]),[z,f]=l.useState(!1),[j,I]=l.useState(!1),[n,p]=l.useState({universityName:"",description:"",universityCode:"",universityPicName:""}),[u,N]=l.useState({}),[Ee,T]=l.useState(""),[L,G]=l.useState(""),[M,H]=l.useState(null),[U,k]=l.useState(!1),[Y,_]=l.useState(null),q=l.useRef(null),J=(t,s)=>{c(s)},V=t=>{v(+t.target.value),c(0)},x=JSON.parse(sessionStorage.getItem("user")),C={"Content-type":"application/json",Authorization:"Bearer "+x.accessToken},K=`${m}/file/downloadFile/?filePath=`,b=async()=>{try{const s=(await ge(C)).data.content;if(s){const r=s.map(a=>({universityId:a.universityId,universityName:a.universityName,description:a.description,file:a.universityPicPath===null?"NO IMAGE FOUND":e.jsx("img",{src:K+a.universityPicPath,alt:a.universityPicName,style:{width:100,height:50}}),insertedDate:$(a.insertedDate).format("L"),updatedDate:$(a.updatedDate).format("L"),createdBy:a.createdBy?a.createdBy.userName:"No User",updatedBy:a.updatedBy?a.updatedBy.userName:"No User"}));S(r)}else S([])}catch(t){console.error("Error fetching data:",t)}};l.useEffect(()=>{b()},[U]);const Q=async t=>{t.preventDefault();const s=F();if(Object.keys(s).length>0){N(s);return}const r={...n,createdBy:{userId:x.userId}};console.log(r);try{const a=await Ce(r,C);a.data.responseCode===201?(k(!U),f(!1),b()):alert(a.data.errorMessage||"Failed to add University.")}catch{}b()},X=async t=>{t.preventDefault();const s=F();if(Object.keys(s).length>0){N(s);return}const r={universityId:Y,universityName:n.universityName,description:n.description,universityPicName:L,updatedBy:{userId:x.userId}};console.log(r);try{const a=await Ne(r,C);a.data.responseCode===201?(k(!U),f(!1),I(!1),setcollegeId(null),p({universityName:"",description:"",universityPicName:"",universityCode:det.universityCode||""})):alert(a.data.errorMessage)}catch(a){console.error(a)}finally{}f(!1),b()},Z=async t=>{var r,a;if(t.preventDefault(),!M){T("Please select a file"),d.fire({icon:"error",title:"No file selected",text:"Please select a file to upload."});return}const s=new FormData;s.append("file",M);try{const y=await g.post(`${m}/file/uploadFile`,s,{headers:{"content-type":"multipart/form-data",Authorization:"Bearer "+x.accessToken}});G(y.data.fileName),p({...n,universityPicName:y.data.fileName}),T(""),d.fire({target:document.getElementById("your-dialog-id"),icon:"success",title:"File Uploaded",text:y.data.message||"Your file has been uploaded successfully!"})}catch(y){console.error("Error uploading file:",y),d.fire({icon:"error",title:"Upload Failed",text:((a=(r=y==null?void 0:y.response)==null?void 0:r.data)==null?void 0:a.errorMessage)||"Something went wrong during upload."})}},F=()=>{const t={};return(!n.universityName||n.universityName.trim()==="")&&(t.universityName="Enter the university name"),(!n.description||n.description.trim()==="")&&(t.description="Enter the description"),(!n.universityPicName||n.universityPicName.trim()==="")&&(t.universityPicName="Select the file"),(!n.universityCode||n.universityCode.trim()==="")&&(t.universityCode="Enter the university code"),t},w=t=>{p({...n,[t.target.name]:t.target.value,createdBy:{userId:x.userId}}),N({...u,[t.target.name]:null})},ee=()=>{I(!1),p({universityName:"",description:"",universityPicName:""}),f(!0)},te=async t=>{I(!0),f(!0);try{const r=(await xe(t,C)).data;console.log(r),_(r.universityId),p({universityName:r.universityName,description:r.description,universityPicName:r.universityPicName})}catch(s){console.error("Error fetching university details:",s)}},re=async t=>{try{await be(t,C),b()}catch(s){console.error("Error deleting university:",s)}};return e.jsxs(se,{title:e.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"University"}),e.jsxs(E,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px",backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:ee,children:["Add",e.jsx(ae,{sx:{color:"#fff"}})]})]}),children:[e.jsx(h,{container:!0,spacing:ne}),e.jsxs(oe,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(le,{sx:{maxHeight:440},children:e.jsxs(de,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(ce,{children:e.jsx(O,{children:R.map(t=>e.jsx(B,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(ue,{children:D.slice(o*i,o*i+i).map((t,s)=>e.jsxs(O,{hover:!0,role:"checkbox",tabIndex:-1,children:[e.jsx(B,{children:o*i+s+1}),R.filter(r=>r.id!=="moduleId").map(r=>e.jsx(B,{align:r.align,children:r.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(W,{onClick:()=>te(t.universityId),sx:{color:"#03045E"},children:e.jsx(ye,{})}),e.jsx(W,{onClick:()=>re(t.universityId),color:"error",children:e.jsx(ve,{})})]}):t[r.id]},r.id))]},t.universityId))})]})}),e.jsx(fe,{rowsPerPageOptions:[10,25,100],component:"div",count:D.length,rowsPerPage:i,page:o,onPageChange:J,onRowsPerPageChange:V})]}),e.jsxs(me,{open:z,onClose:()=>f(!1),fullWidth:!0,maxWidth:"md",id:"your-dialog-id",children:[e.jsx(pe,{sx:{fontSize:"16px"},children:j?"Edit University":"Add University"}),e.jsxs(A,{component:"form",onSubmit:j?X:Q,noValidate:!0,sx:{p:3},children:[e.jsxs(h,{container:!0,spacing:2,children:[e.jsx(h,{item:!0,xs:12,children:e.jsx(P,{fullWidth:!0,label:"University Name",name:"universityName",value:n.universityName,onChange:w,error:!!u.universityName,helperText:u.universityName,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(P,{fullWidth:!0,label:"University Code",name:"universityCode",value:n.universityCode,onChange:w,error:!!u.universityCode,helperText:u.universityCode,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsx(h,{item:!0,xs:12,children:e.jsx(P,{fullWidth:!0,label:"Description",name:"description",value:n.description,onChange:w,error:!!u.description,helperText:u.description,multiline:!0,rows:3,sx:{"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#03045E"}},"& .MuiInputLabel-root.Mui-focused":{color:"#03045E"}}})}),e.jsxs(h,{item:!0,xs:12,children:[e.jsx(P,{fullWidth:!0,margin:"normal",label:"File Name",name:"universityPicName",value:n.universityPicName,disabled:!0,error:!!u.universityPicName,helperText:u.universityPicName,InputProps:{endAdornment:e.jsx(E,{variant:"contained",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},onClick:Z,children:"Upload"})}}),e.jsx("input",{type:"file",onChange:t=>{const s=t.target.files[0];s&&(H(s),p(r=>({...r,universityPicName:s.name})),N(r=>({...r,universityPicName:""})))},ref:q,style:{marginTop:20}})]})]}),e.jsxs(he,{children:[e.jsx(E,{onClick:()=>f(!1),sx:{color:"#03045E"},children:"Cancel"}),e.jsxs(E,{type:"submit",variant:"contained",sx:{backgroundColor:"#03045E","&:hover":{backgroundColor:"#03045E",opacity:.9}},children:[j?"Update":"Save"," "]})]})]})]})]})};export{je as default};
